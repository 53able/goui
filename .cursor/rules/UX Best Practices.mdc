---
alwaysApply: false
description: UI/UX実装ガイド。ボタン状態、フォーム、フィードバック、エラー処理、アクセシビリティの必須/推奨パターンを提供
---
# UXベストプラクティス規約

> **適用タイミング**: UI/UXに関わるコンポーネント設計・実装時
> **出典**: ドナルド・ノーマン『誰のためのデザイン？』

---

## 原則の優先順位

優先度の高い順に適用すること：

| 優先度 | 原則 | 要約 |
|:------:|------|------|
| 1 | エラー防止 | ユーザーに誤りをさせない設計 |
| 2 | フィードバック | 操作結果を即座に明確に伝える |
| 3 | 発見可能性 | 操作方法を見つけられる |
| 4 | アフォーダンス | 見た目で機能が分かる |
| 5 | マッピング | 操作と結果が直感的に対応 |
| 6 | 制約 | 誤操作を物理的/論理的に防ぐ |

---

## 🔴 必須: ボタン・クリッカブル要素

### ✅ DO
- クリック可能な要素は**視覚的に明確に区別**する（色・形状・影）
- **ホバー/フォーカス/アクティブ状態**を必ず実装する
- **disabled状態**は色の変化 + `cursor: not-allowed` で表現する
- クリック後は**即座にフィードバック**を返す（ローディング状態など）

### ❌ DON'T
- テキストのみでクリック可能性を示す（色+下線 or ボタン形状が必須）
- クリック後のフィードバックなしに処理を開始する
- disabled状態を色だけで表現する（cursor変更も必須）

### 具体例

```tsx
// ✅ Good: 状態が明確、フィードバックあり
<Button
  variant="primary"
  disabled={!isValid}
  loading={isSubmitting}
  onClick={handleSubmit}
>
  {isSubmitting ? "送信中..." : "送信する"}
</Button>
```

```tsx
// ❌ Bad: クリック可能性が不明、フィードバックなし
<span onClick={handleSubmit}>送信</span>
```

---

## 🔴 必須: フォーム入力

### ✅ DO
- **入力形式をラベル/プレースホルダーで明示**する（例: `例: 03-1234-5678`）
- バリデーションエラーは**該当フィールドの直下**に赤色で表示
- **入力内容はエラー後も保持**する（ユーザーに再入力させない）
- 必須項目には**アスタリスク（*）**を付与しラベルで明示

### ❌ DON'T
- 送信後にページ全体をリロードして入力を消す
- 汎用的なエラーメッセージを使う（「入力エラー」は NG）
- 全てのエラーをページ上部にまとめて表示するだけにする

### 具体例

```tsx
// ✅ Good: 具体的なエラーメッセージ、フィールド直下に表示
<FormField>
  <Label htmlFor="email">メールアドレス *</Label>
  <Input
    id="email"
    type="email"
    placeholder="例: taro@example.com"
    aria-invalid={!!errors.email}
  />
  {errors.email && (
    <ErrorMessage>
      メールアドレスの形式が正しくありません（例: taro@example.com）
    </ErrorMessage>
  )}
</FormField>
```

```tsx
// ❌ Bad: 何が問題か不明、どう修正すべきか分からない
<div className="error">入力エラーがあります</div>
```

---

## 🔴 必須: フィードバック

### ✅ DO
- 非同期操作には**必ずローディング状態**を表示する（スピナー、スケルトン等）
- 成功/失敗を**Toast/Alert で明示的に通知**する
- 処理時間が3秒を超える場合は**進捗表示**を検討する
- 操作完了後は**次のアクション**を明示する（「一覧に戻る」ボタン等）

### ❌ DON'T
- 操作後に何も表示しない（ユーザーが不安になる）
- フィードバックなく画面遷移する
- エラー時にページをリロードするだけ

### 具体例

```tsx
// ✅ Good: 状態に応じた明確なフィードバック
const handleSave = async () => {
  setIsLoading(true);
  try {
    await saveData();
    toast.success("保存しました");
  } catch (error) {
    toast.error("保存に失敗しました。時間をおいて再度お試しください。");
  } finally {
    setIsLoading(false);
  }
};
```

---

## 🔴 必須: エラー処理

### ✅ DO
- エラーメッセージは**「何が問題」+「どうすれば解決」**を含める
- エラー箇所を**ハイライト**し、必要に応じて**スクロール位置を調整**
- 取り消し可能な操作には**Undo機能**を提供する
- エラーからの回復手段を常に提供する（「やり直す」「サポートに連絡」等）

### ❌ DON'T
- 技術的なエラーコード/スタックトレースをそのまま表示
- ユーザーを責める表現を使う
- エラー状態から抜け出す手段を提供しない

### エラーメッセージの書き方

| ❌ Bad | ✅ Good |
|--------|---------|
| 入力エラー | メールアドレスの形式が正しくありません |
| 正しく入力してください | 電話番号は数字のみで入力してください（例: 09012345678） |
| Error: 500 | 処理中にエラーが発生しました。時間をおいて再度お試しください |
| 無効な値です | 金額は0以上の数値を入力してください |

---

## 🟡 推奨: マッピング

### ✅ DO
- フォームの**送信ボタンは入力欄の直後**に配置
- **矢印アイコン**は一般的な解釈に従う（← = 戻る、→ = 進む）
- 関連する要素は**空間的に近接**配置する
- **モーダルの閉じるボタン**は右上に配置（慣習に従う）

### ❌ DON'T
- 送信ボタンをフォームから離れた場所に配置
- 独自の矢印の意味づけをする（混乱の原因）
- 関連のない要素を近くに配置する

---

## 🟡 推奨: 制約による誤操作防止

### ✅ DO
- **必須項目が未入力**の間は送信ボタンを `disabled` にする
- **破壊的操作**（削除、上書き等）には確認ダイアログを必須とする
- 日付入力には **DatePicker**、選択肢限定には **Select** を使用
- 入力形式が決まっている場合は**入力制限**を設ける（数字のみ、文字数制限等）

### ❌ DON'T
- フリーテキスト入力で形式を強制するだけ（入力時点で制限すべき）
- 破壊的操作をワンクリックで実行可能にする
- 確認なしにデータを永久削除する

### 具体例

```tsx
// ✅ Good: 破壊的操作に確認ダイアログ
<AlertDialog>
  <AlertDialogTrigger asChild>
    <Button variant="destructive">削除</Button>
  </AlertDialogTrigger>
  <AlertDialogContent>
    <AlertDialogHeader>
      <AlertDialogTitle>本当に削除しますか？</AlertDialogTitle>
      <AlertDialogDescription>
        この操作は取り消せません。「{itemName}」を完全に削除します。
      </AlertDialogDescription>
    </AlertDialogHeader>
    <AlertDialogFooter>
      <AlertDialogCancel>キャンセル</AlertDialogCancel>
      <AlertDialogAction onClick={handleDelete}>削除する</AlertDialogAction>
    </AlertDialogFooter>
  </AlertDialogContent>
</AlertDialog>
```

---

## 🟡 推奨: アクセシビリティ

### ✅ DO
- **色だけに頼らない**（アイコン+テキストで補完）
- **キーボード操作**をサポートする（Tab移動、Enter実行、Escape閉じる）
- 適切な **aria属性** を付与する
- **コントラスト比**を十分に確保する（WCAG 2.1 AA基準: 4.5:1以上）

### ❌ DON'T
- 色だけでエラー/成功を表現（色覚多様性への配慮不足）
- マウス操作のみでしか使えないUIを作る
- フォーカス順序を無視した tabindex 設定

---

## クイックチェックリスト

実装完了時に以下を確認すること：

- [ ] クリック可能な要素は視覚的に識別できるか？
- [ ] ホバー/フォーカス/アクティブ/disabled 状態が実装されているか？
- [ ] 非同期操作にローディング状態があるか？
- [ ] 成功/失敗時にフィードバックがあるか？
- [ ] エラーメッセージは具体的で、解決方法を示しているか？
- [ ] 破壊的操作に確認ダイアログがあるか？
- [ ] キーボードだけで操作できるか？
- [ ] 色だけに頼っていないか？
